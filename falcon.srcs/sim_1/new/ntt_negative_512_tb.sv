`timescale 1ns / 1ps

module ntt_negative_512_tb;

  logic clk;
  logic rst_n;

  logic mode;
  logic start;
  logic signed [14:0] input_polynomial[512];
  logic signed [14:0] output_polynomial[512];
  logic signed [14:0] expected_output_polynomial[512];
  logic done;

  ntt_negative #(
                 .N(512)
               )uut(
                 .clk(clk),
                 .rst_n(rst_n),
                 .mode(mode),
                 .start(start),
                 .input_polynomial(input_polynomial),
                 .done(done),
                 .output_polynomial(output_polynomial)
               );

  always #5 clk = ~clk;

  initial begin
    clk = 1;

    // Test 1: NTT of polynomial size 512
    rst_n = 0;
    #10;
    rst_n = 1;
    mode = 0;
    input_polynomial = {0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511};

    // Start NTT
    start = 1;
    #10;
    start = 0;

    // Wait for NTT to finish
    while (!done)
      #10;

    // Check output
    expected_output_polynomial = {3563,6312,914,1410,11670,3443,12179,10019,517,1596,4599,12059,2269,11382,7426,1130,246,10435,6449,299,1812,4928,12005,1256,5618,6703,7229,8046,8409,9999,3485,3908,8088,7095,8931,4210,10742,1391,12033,6888,10845,11474,3669,11279,1536,9546,8664,526,7131,972,5209,3222,4965,9341,7660,11592,10113,10612,9779,5716,7087,2728,10156,9673,2188,5184,413,1664,4718,11832,4207,11117,3116,6620,9465,3331,5582,3095,9217,9987,8073,832,11453,6766,4911,9219,10507,6306,3267,10701,4245,7238,4352,320,9126,9699,6384,2256,11657,3197,8966,7195,6343,9782,673,10393,11335,7383,2100,10387,7057,343,10741,6579,8973,1239,10562,3883,6143,9990,9572,6346,6050,76,6755,10825,3082,6983,5350,7948,7847,10678,1710,3253,1995,3120,2935,11778,2829,25,4509,11522,5213,1164,12172,7585,4010,4452,3504,7300,4992,10211,10931,10760,7215,6174,2156,4415,4856,1494,11727,606,5760,7340,5890,3864,152,3991,1009,10467,2762,7702,8942,4167,8794,10354,395,400,12033,6403,10161,8259,3337,7058,4704,976,1130,4295,7457,12247,3146,12118,2185,2315,1282,9736,5480,1856,8275,7214,803,7655,6805,10501,3883,517,9425,7414,10590,9221,11611,2226,7730,5299,2380,6630,10840,11522,3233,1815,4668,470,5278,99,9789,8865,1219,8020,4045,9786,9554,9646,3100,8216,7752,4197,6488,7443,973,11347,3678,1191,1617,10040,3597,8338,3826,7791,5447,4709,3229,8382,3421,5631,10708,11939,6129,8920,1131,3898,3491,8590,3003,4573,1938,6517,9116,8799,8244,6206,365,6723,8657,3644,11062,8479,9828,11980,358,10395,9394,9294,8305,3478,6662,5985,5560,3132,3294,4260,12266,8324,1222,2936,6024,4583,6173,6324,1261,11311,4052,10597,5436,1985,4970,10967,5014,6398,5370,8452,4710,12110,10504,11694,7160,7661,10528,9185,6793,8528,5583,4772,8083,7760,1698,9982,6634,12261,1083,1331,8591,4584,3451,621,8451,1812,6674,3166,6735,5522,2302,9304,5867,3880,7341,11250,5118,8941,4613,10319,8373,11294,11138,4506,6965,2760,922,3674,8997,2111,4625,9323,4636,2483,11972,7810,8697,11170,10672,12189,8806,6892,8860,11349,2003,10792,5550,5208,4549,3126,4171,7412,7128,10965,5063,4584,8348,9487,6958,10013,1734,2939,9743,1997,5443,10604,3391,2562,4459,5609,9476,5541,8926,11417,10839,11866,5724,1746,8722,8368,1825,6139,2520,796,108,5461,3127,5092,6433,2272,4957,8230,5750,583,66,4352,2221,6886,1973,8419,10731,3058,7852,3344,8762,4351,8103,5791,11749,4068,6319,1253,117,7230,7956,7939,12126,10206,11079,7563,4588,10690,4322,6576,3033,3865,2889,3751,7025,7611,6391,6172,10611,7941,11764,9654,5909,6316,7046,492,10679,1256,10805,2942,5448,953,5759,1373,7998,730,1904,4041,2549,2099,10519,7012,7732,10196,8031,5521,590,7304,9771,4816,10792,9827,8642,3430,8166,8118,5304,7964,4877,95,4303,4101,1620,9032,5499,7620,10736,0};
    if (output_polynomial === expected_output_polynomial)
      $display("Test 1: Passed");
    else
      $fatal(1, "Test 1: Failed. Expected: %p, Got: %p",expected_output_polynomial,output_polynomial);

    // Test 2: INTT of polynomial size 512
    rst_n = 0;
    #10;
    rst_n = 1;
    mode = 1;
    input_polynomial = {3563,6312,914,1410,11670,3443,12179,10019,517,1596,4599,12059,2269,11382,7426,1130,246,10435,6449,299,1812,4928,12005,1256,5618,6703,7229,8046,8409,9999,3485,3908,8088,7095,8931,4210,10742,1391,12033,6888,10845,11474,3669,11279,1536,9546,8664,526,7131,972,5209,3222,4965,9341,7660,11592,10113,10612,9779,5716,7087,2728,10156,9673,2188,5184,413,1664,4718,11832,4207,11117,3116,6620,9465,3331,5582,3095,9217,9987,8073,832,11453,6766,4911,9219,10507,6306,3267,10701,4245,7238,4352,320,9126,9699,6384,2256,11657,3197,8966,7195,6343,9782,673,10393,11335,7383,2100,10387,7057,343,10741,6579,8973,1239,10562,3883,6143,9990,9572,6346,6050,76,6755,10825,3082,6983,5350,7948,7847,10678,1710,3253,1995,3120,2935,11778,2829,25,4509,11522,5213,1164,12172,7585,4010,4452,3504,7300,4992,10211,10931,10760,7215,6174,2156,4415,4856,1494,11727,606,5760,7340,5890,3864,152,3991,1009,10467,2762,7702,8942,4167,8794,10354,395,400,12033,6403,10161,8259,3337,7058,4704,976,1130,4295,7457,12247,3146,12118,2185,2315,1282,9736,5480,1856,8275,7214,803,7655,6805,10501,3883,517,9425,7414,10590,9221,11611,2226,7730,5299,2380,6630,10840,11522,3233,1815,4668,470,5278,99,9789,8865,1219,8020,4045,9786,9554,9646,3100,8216,7752,4197,6488,7443,973,11347,3678,1191,1617,10040,3597,8338,3826,7791,5447,4709,3229,8382,3421,5631,10708,11939,6129,8920,1131,3898,3491,8590,3003,4573,1938,6517,9116,8799,8244,6206,365,6723,8657,3644,11062,8479,9828,11980,358,10395,9394,9294,8305,3478,6662,5985,5560,3132,3294,4260,12266,8324,1222,2936,6024,4583,6173,6324,1261,11311,4052,10597,5436,1985,4970,10967,5014,6398,5370,8452,4710,12110,10504,11694,7160,7661,10528,9185,6793,8528,5583,4772,8083,7760,1698,9982,6634,12261,1083,1331,8591,4584,3451,621,8451,1812,6674,3166,6735,5522,2302,9304,5867,3880,7341,11250,5118,8941,4613,10319,8373,11294,11138,4506,6965,2760,922,3674,8997,2111,4625,9323,4636,2483,11972,7810,8697,11170,10672,12189,8806,6892,8860,11349,2003,10792,5550,5208,4549,3126,4171,7412,7128,10965,5063,4584,8348,9487,6958,10013,1734,2939,9743,1997,5443,10604,3391,2562,4459,5609,9476,5541,8926,11417,10839,11866,5724,1746,8722,8368,1825,6139,2520,796,108,5461,3127,5092,6433,2272,4957,8230,5750,583,66,4352,2221,6886,1973,8419,10731,3058,7852,3344,8762,4351,8103,5791,11749,4068,6319,1253,117,7230,7956,7939,12126,10206,11079,7563,4588,10690,4322,6576,3033,3865,2889,3751,7025,7611,6391,6172,10611,7941,11764,9654,5909,6316,7046,492,10679,1256,10805,2942,5448,953,5759,1373,7998,730,1904,4041,2549,2099,10519,7012,7732,10196,8031,5521,590,7304,9771,4816,10792,9827,8642,3430,8166,8118,5304,7964,4877,95,4303,4101,1620,9032,5499,7620,10736,0};

    // Start INTT
    start = 1;
    #10;
    start = 0;

    // Wait for INTT to finish
    while (!done)
      #10;

    // Check output
    expected_output_polynomial = {0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511};
    if (output_polynomial === expected_output_polynomial)
      $display("Test 2: Passed");
    else
      $fatal(1, "Test 2: Failed. Expected: %p, Got: %p",expected_output_polynomial,output_polynomial);

    // Test 3: NTT of polynomial size 512 with negative numbers
    rst_n = 0;
    #10;
    rst_n = 1;
    mode = 0;
    input_polynomial = {0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -61, -62, -63, -64, -65, -66, -67, -68, -69, -70, -71, -72, -73, -74, -75, -76, -77, -78, -79, -80, -81, -82, -83, -84, -85, -86, -87, -88, -89, -90, -91, -92, -93, -94, -95, -96, -97, -98, -99, -100, -101, -102, -103, -104, -105, -106, -107, -108, -109, -110, -111, -112, -113, -114, -115, -116, -117, -118, -119, -120, -121, -122, -123, -124, -125, -126, -127, -128, -129, -130, -131, -132, -133, -134, -135, -136, -137, -138, -139, -140, -141, -142, -143, -144, -145, -146, -147, -148, -149, -150, -151, -152, -153, -154, -155, -156, -157, -158, -159, -160, -161, -162, -163, -164, -165, -166, -167, -168, -169, -170, -171, -172, -173, -174, -175, -176, -177, -178, -179, -180, -181, -182, -183, -184, -185, -186, -187, -188, -189, -190, -191, -192, -193, -194, -195, -196, -197, -198, -199, -200, -201, -202, -203, -204, -205, -206, -207, -208, -209, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -231, -232, -233, -234, -235, -236, -237, -238, -239, -240, -241, -242, -243, -244, -245, -246, -247, -248, -249, -250, -251, -252, -253, -254, -255, -256, -257, -258, -259, -260, -261, -262, -263, -264, -265, -266, -267, -268, -269, -270, -271, -272, -273, -274, -275, -276, -277, -278, -279, -280, -281, -282, -283, -284, -285, -286, -287, -288, -289, -290, -291, -292, -293, -294, -295, -296, -297, -298, -299, -300, -301, -302, -303, -304, -305, -306, -307, -308, -309, -310, -311, -312, -313, -314, -315, -316, -317, -318, -319, -320, -321, -322, -323, -324, -325, -326, -327, -328, -329, -330, -331, -332, -333, -334, -335, -336, -337, -338, -339, -340, -341, -342, -343, -344, -345, -346, -347, -348, -349, -350, -351, -352, -353, -354, -355, -356, -357, -358, -359, -360, -361, -362, -363, -364, -365, -366, -367, -368, -369, -370, -371, -372, -373, -374, -375, -376, -377, -378, -379, -380, -381, -382, -383, -384, -385, -386, -387, -388, -389, -390, -391, -392, -393, -394, -395, -396, -397, -398, -399, -400, -401, -402, -403, -404, -405, -406, -407, -408, -409, -410, -411, -412, -413, -414, -415, -416, -417, -418, -419, -420, -421, -422, -423, -424, -425, -426, -427, -428, -429, -430, -431, -432, -433, -434, -435, -436, -437, -438, -439, -440, -441, -442, -443, -444, -445, -446, -447, -448, -449, -450, -451, -452, -453, -454, -455, -456, -457, -458, -459, -460, -461, -462, -463, -464, -465, -466, -467, -468, -469, -470, -471, -472, -473, -474, -475, -476, -477, -478, -479, -480, -481, -482, -483, -484, -485, -486, -487, -488, -489, -490, -491, -492, -493, -494, -495, -496, -497, -498, -499, -500, -501, -502, -503, -504, -505, -506, -507, -508, -509, -510, -511};

    // Start NTT
    start = 1;
    #10;
    start = 0;

    // Wait for NTT to finish
    while (!done)
      #10;

    // Check output
    expected_output_polynomial = {8726, 5977, 11375, 10879, 619, 8846, 110, 2270, 11772, 10693, 7690, 230, 10020, 907, 4863, 11159, 12043, 1854, 5840, 11990, 10477, 7361, 284, 11033, 6671, 5586, 5060, 4243, 3880, 2290, 8804, 8381, 4201, 5194, 3358, 8079, 1547, 10898, 256, 5401, 1444, 815, 8620, 1010, 10753, 2743, 3625, 11763, 5158, 11317, 7080, 9067, 7324, 2948, 4629, 697, 2176, 1677, 2510, 6573, 5202, 9561, 2133, 2616, 10101, 7105, 11876, 10625, 7571, 457, 8082, 1172, 9173, 5669, 2824, 8958, 6707, 9194, 3072, 2302, 4216, 11457, 836, 5523, 7378, 3070, 1782, 5983, 9022, 1588, 8044, 5051, 7937, 11969, 3163, 2590, 5905, 10033, 632, 9092, 3323, 5094, 5946, 2507, 11616, 1896, 954, 4906, 10189, 1902, 5232, 11946, 1548, 5710, 3316, 11050, 1727, 8406, 6146, 2299, 2717, 5943, 6239, 12213, 5534, 1464, 9207, 5306, 6939, 4341, 4442, 1611, 10579, 9036, 10294, 9169, 9354, 511, 9460, 12264, 7780, 767, 7076, 11125, 117, 4704, 8279, 7837, 8785, 4989, 7297, 2078, 1358, 1529, 5074, 6115, 10133, 7874, 7433, 10795, 562, 11683, 6529, 4949, 6399, 8425, 12137, 8298, 11280, 1822, 9527, 4587, 3347, 8122, 3495, 1935, 11894, 11889, 256, 5886, 2128, 4030, 8952, 5231, 7585, 11313, 11159, 7994, 4832, 42, 9143, 171, 10104, 9974, 11007, 2553, 6809, 10433, 4014, 5075, 11486, 4634, 5484, 1788, 8406, 11772, 2864, 4875, 1699, 3068, 678, 10063, 4559, 6990, 9909, 5659, 1449, 767, 9056, 10474, 7621, 11819, 7011, 12190, 2500, 3424, 11070, 4269, 8244, 2503, 2735, 2643, 9189, 4073, 4537, 8092, 5801, 4846, 11316, 942, 8611, 11098, 10672, 2249, 8692, 3951, 8463, 4498, 6842, 7580, 9060, 3907, 8868, 6658, 1581, 350, 6160, 3369, 11158, 8391, 8798, 3699, 9286, 7716, 10351, 5772, 3173, 3490, 4045, 6083, 11924, 5566, 3632, 8645, 1227, 3810, 2461, 309, 11931, 1894, 2895, 2995, 3984, 8811, 5627, 6304, 6729, 9157, 8995, 8029, 23, 3965, 11067, 9353, 6265, 7706, 6116, 5965, 11028, 978, 8237, 1692, 6853, 10304, 7319, 1322, 7275, 5891, 6919, 3837, 7579, 179, 1785, 595, 5129, 4628, 1761, 3104, 5496, 3761, 6706, 7517, 4206, 4529, 10591, 2307, 5655, 28, 11206, 10958, 3698, 7705, 8838, 11668, 3838, 10477, 5615, 9123, 5554, 6767, 9987, 2985, 6422, 8409, 4948, 1039, 7171, 3348, 7676, 1970, 3916, 995, 1151, 7783, 5324, 9529, 11367, 8615, 3292, 10178, 7664, 2966, 7653, 9806, 317, 4479, 3592, 1119, 1617, 100, 3483, 5397, 3429, 940, 10286, 1497, 6739, 7081, 7740, 9163, 8118, 4877, 5161, 1324, 7226, 7705, 3941, 2802, 5331, 2276, 10555, 9350, 2546, 10292, 6846, 1685, 8898, 9727, 7830, 6680, 2813, 6748, 3363, 872, 1450, 423, 6565, 10543, 3567, 3921, 10464, 6150, 9769, 11493, 12181, 6828, 9162, 7197, 5856, 10017, 7332, 4059, 6539, 11706, 12223, 7937, 10068, 5403, 10316, 3870, 1558, 9231, 4437, 8945, 3527, 7938, 4186, 6498, 540, 8221, 5970, 11036, 12172, 5059, 4333, 4350, 163, 2083, 1210, 4726, 7701, 1599, 7967, 5713, 9256, 8424, 9400, 8538, 5264, 4678, 5898, 6117, 1678, 4348, 525, 2635, 6380, 5973, 5243, 11797, 1610, 11033, 1484, 9347, 6841, 11336, 6530, 10916, 4291, 11559, 10385, 8248, 9740, 10190, 1770, 5277, 4557, 2093, 4258, 6768, 11699, 4985, 2518, 7473, 1497, 2462, 3647, 8859, 4123, 4171, 6985, 4325, 7412, 12194, 7986, 8188, 10669, 3257, 6790, 4669, 1553, 0};
    if (output_polynomial === expected_output_polynomial)
      $display("Test 3: Passed");
    else
      $fatal(1, "Test 3: Failed. Expected: %p, Got: %p",expected_output_polynomial,output_polynomial);
    
    
    // Test 4: NTT of polynomial size 512 with real-world numbers
    rst_n = 0;
    #10;
    rst_n = 1;
    mode = 0;
    input_polynomial = {6, -78, 13, -26, -117, 184, 52, 186, 121, 77, -338, -353, 37, -115, -19, 43, 173, -34, -88, 110, 208, 161, 54, 375, 20, 204, 134, 38, 163, -25, 125, -297, 195, -240, 168, 312, 105, -10, -269, 26, 186, -6, -136, -156, 185, 16, 96, 182, -175, 176, 214, -152, 1, -177, -78, 55, -369, 222, -256, -86, -74, -35, -200, -301, -326, 77, 234, -105, 155, 272, -283, -117, -245, 49, 144, 29, -41, -350, 76, 67, 107, -81, -228, -146, 16, -245, 184, 304, 68, 175, 35, -437, 158, 89, -180, -118, -189, 63, -364, -7, 170, -34, -151, -225, 32, -31, -255, -160, -7, -171, -137, 87, 29, -303, 99, -226, 43, 49, 90, -57, -187, 100, 161, -348, 250, -328, -230, 18, -85, -127, 155, 141, 202, -180, 77, 312, -83, 47, -338, 118, 101, 24, -265, -76, -83, 71, -308, -276, 105, -166, -246, -335, -75, -73, -169, -279, 214, 113, -243, -121, 96, -177, -172, 33, 92, 176, -110, -54, -92, -72, 86, -325, -245, -68, 55, 68, -114, 32, -43, -144, -74, 93, 47, -301, 77, 122, -3, 201, -368, 36, 18, -190, 41, 61, -76, 73, 227, 172, 275, -219, -192, 35, 220, -42, 164, -23, 43, -206, 88, 103, 47, -52, 94, 234, 146, -227, 48, -391, 30, 108, -249, -229, 44, 103, -152, -25, -46, -180, -76, 131, -120, -213, 104, -1, 195, 208, -54, 105, -77, -162, 73, 104, 240, -307, 10, -50, 140, -33, -178, 82, -157, -111, 29, -76, 277, 172, 89, 322, -215, -10, -167, -264, 33, 83, 79, -97, 140, -216, -146, -338, -75, 279, 77, 59, 113, 34, -115, -60, -466, -33, 52, -62, -116, -25, 13, 11, -350, -124, 250, 98, -58, -84, 252, 75, 510, -185, -249, 39, 71, 142, -27, -195, 101, -295, -92, -318, 87, 55, -34, 248, 56, -103, -365, -150, -144, 220, 132, -56, 199, -88, -9, 165, -263, -147, -245, 47, 416, -120, 255, 65, 126, 84, 0, -101, -114, -349, -49, -381, 3, 34, 67, 52, -192, -240, -79, -13, -75, 9, 68, 236, -109, -458, 35, -351, 82, 72, 187, 159, -297, -98, -165, 44, -32, -23, -507, -144, 4, -133, 195, 63, -105, -66, -168, -108, -119, 110, -179, -244, 208, -48, 101, -311, -54, -54, -289, 169, 124, -7, 91, -18, -91, 5, 117, 157, 77, 184, 152, -141, 139, -113, -293, 146, -1, 78, 76, -88, 51, -49, 11, -296, 588, -323, -203, -28, -191, 89, 32, 188, -127, -32, -110, 42, -313, 165, 66, 109, -155, 238, 77, -108, -26, 200, 95, -128, -70, -257, -129, -79, 85, 24, -122, -55, -196, 209, 107, 20, 153, 323, -116, 180, -97, -362, 147, -85, 71, 111, 113, 252, -39, -74, 177, 58, 90, -23, -406, -31, -73, 404, -55, 136, 136, 186, -66, 29, -225, 210, -174, -407, 58, -141, -5, 30, -245, -369, -198, 291, 80, 77, 294, 172, 184, 27, 30, 163, 132, -125, -5, -6, -1, 220, 115, -136, 8, -154, -459, 287, 74, 161, 133, -118, -224, 67};

    // Start NTT
    start = 1;
    #10;
    start = 0;

    // Wait for NTT to finish
    while (!done)
      #10;

    // Check output
    expected_output_polynomial = {4553, 3685, 9548, 12094, 12275, 8893, 11243, 2727, 668, 5428, 5879, 3884, 11758, 8674, 7258, 12177, 2891, 1661, 5713, 2798, 6254, 8500, 504, 3748, 10558, 6380, 7099, 9627, 1582, 4181, 5565, 2999, 7995, 4586, 8201, 7384, 2626, 2785, 4212, 1717, 7462, 11314, 9422, 5103, 8466, 6801, 10850, 12121, 4748, 5713, 1047, 4833, 3387, 8728, 8336, 189, 6927, 7461, 20, 10722, 2203, 6176, 11590, 4180, 4788, 6870, 2855, 6345, 5005, 8900, 7734, 194, 2575, 5329, 10426, 2610, 7115, 1236, 1838, 10298, 3273, 11649, 1014, 4853, 7347, 5514, 6434, 8186, 6679, 7258, 10935, 6340, 12191, 4976, 12109, 6406, 6218, 9389, 3947, 1653, 6197, 4259, 1931, 9361, 9317, 3728, 5582, 1436, 1613, 11014, 11065, 11476, 6907, 5137, 4687, 6694, 11447, 4722, 4496, 6900, 9081, 8965, 4529, 10206, 5415, 7123, 7829, 9848, 1515, 9056, 2107, 947, 9517, 570, 9855, 11992, 930, 9077, 5148, 7736, 4230, 7193, 10405, 4300, 2120, 11384, 6400, 2310, 5001, 6343, 10997, 7397, 4613, 8067, 10562, 4349, 407, 1251, 1993, 1832, 3219, 6672, 38, 12274, 11583, 2026, 5633, 9137, 1356, 2444, 6106, 10248, 11757, 2212, 9982, 2022, 9693, 9708, 11683, 5410, 9285, 11494, 3908, 825, 7600, 7323, 7420, 774, 3794, 9973, 5704, 1376, 1895, 9026, 9364, 7275, 11095, 10820, 11378, 2167, 5430, 2143, 753, 11457, 476, 5429, 7706, 9660, 11032, 2500, 8832, 8711, 9115, 10483, 11355, 11372, 2214, 7319, 11712, 6160, 7521, 184, 5066, 3817, 1145, 7191, 3636, 8026, 1398, 1314, 11748, 6873, 5613, 9716, 6323, 6177, 2281, 6763, 283, 9470, 5222, 10243, 7794, 732, 3303, 11396, 3402, 10322, 7636, 3171, 5565, 4403, 3850, 11920, 8301, 9767, 552, 1506, 4300, 7837, 633, 2258, 8254, 10009, 8939, 9, 2336, 7300, 6160, 11782, 4111, 12286, 2219, 4563, 4497, 4904, 9384, 7069, 4009, 4643, 8329, 3733, 12168, 1761, 510, 11550, 7308, 6777, 438, 2765, 9940, 5988, 5940, 8007, 10735, 10705, 913, 124, 11192, 2085, 1822, 9271, 6046, 7478, 9758, 1749, 3927, 7159, 10263, 6126, 6491, 8036, 2410, 3780, 3911, 11021, 4718, 807, 22, 4187, 7382, 11297, 1584, 11115, 5617, 1409, 455, 1576, 9129, 9110, 8078, 3611, 3219, 7483, 10249, 1675, 8953, 8683, 6770, 2934, 5389, 9769, 6346, 8246, 6793, 6223, 1598, 6834, 9862, 10265, 3860, 815, 4518, 3694, 4665, 1381, 10650, 2872, 11789, 88, 3052, 5483, 3816, 8203, 11699, 9780, 9032, 7920, 7687, 11607, 6814, 5812, 4020, 9492, 2118, 6778, 4830, 6132, 11276, 213, 4779, 10692, 9618, 5599, 9238, 10880, 1921, 5515, 9376, 6080, 5855, 9268, 8096, 6182, 3733, 5172, 1394, 10398, 5953, 5897, 1123, 1674, 7187, 7562, 8124, 4423, 8037, 7532, 10499, 8203, 10716, 2484, 10043, 488, 2038, 5542, 10083, 9685, 163, 10997, 9564, 8519, 10426, 4538, 3021, 9162, 11668, 11342, 34, 5136, 11639, 9135, 3209, 2074, 6175, 9829, 1401, 1140, 7040, 376, 11686, 4084, 8044, 5929, 2962, 9825, 11557, 11752, 11089, 821, 4147, 1961, 182, 1575, 9563, 6334, 374, 12041, 4843, 10306, 8350, 6472, 4420, 4532, 11277, 9061, 10506, 5966, 10234, 8673, 7732, 7004, 10050, 1714, 10227, 511, 3982, 1749, 9971, 74, 1351, 11729, 12125, 12137, 11705, 7941, 9402, 6466, 3264, 2411, 9973, 9941, 4663, 8837, 8265, 6029, 12208, 5347, 6805, 6248, 6869, 9199, 10288, 10804, 7224, 23, 7091, 5213, 7101, 1673, 10618, 11315};
    if (output_polynomial === expected_output_polynomial)
      $display("Test 4: Passed");
    else
      $fatal(1, "Test 4: Failed. Expected: %p, Got: %p",expected_output_polynomial,output_polynomial);


    $display("All tests for ntt_negative_512 passed!");
    $finish;
  end

endmodule
